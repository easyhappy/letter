<div class="panel -dark">
        <!-- Panel Heading -->
  <div class="panel-heading">
    <h4>Data Table</h4>
  </div>
  <!-- /Panel Heading -->
  <div class="form -dark">
    <table class="table -dark" id="datatable" data-url="<%= request.path %>" data-keyword="<%= params['key']%>" data-total-page="<%= params['total_page'] %>" data-current-page="<%= params['page'] %>" >
      <thead>
        <tr>
          <th>Neon Id</th>
          <th>昵称</th>
          <th>头像</th>
          <th>注册时间</th>
        </tr>
      </thead>
      <tbody>
        <% @users.each do |user| %>
          <tr>
            <td class=><%= user.name %></td>
            <td class="-user -detailed"><%= user.nickname %></td>
            <td class="-user -detailed"><a href="#"><%= image_tag user.avatar_url %></a></td>
            <td class="-user -detailed"><%= user.created_at %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
<script type="text/javascript">
  // page: 11024
  var oTable = $('#datatable').dataTable({"pagingType": "full_numbers", "tabIndex": 2, "language": {
          "paginate": {
              "previous": "上一页", "first": "第一页",
               "next": "下一页", "last": "最后一页"
             },
          "info": " ",
          "infoEmpty": " ",
          "searchPlaceholder": "NeonId或昵称"
           }
         });

 $("#datatable_filter").append("<div class='btn-list'><a class='btn -success search-btn' href='#'>确定</a></div>")
 var table = $('#datatable')
 var keyword = table.attr("data-keyword")
 var base_path = table.attr("data-url")
 var total_page = parseInt(table.attr("data-total-page"))
 var current_page = parseInt(table.attr("data-current-page"))
 //oTable.fnFilter(keyword);
 $("#datatable_paginate .-active a").html(current_page)
 if( current_page == 1){
      $("#datatable_first a").hide()
      $("#datatable_previous").hide()
 }else{
   $("#datatable_first a").click(function(){
      if(!!keyword){
        window.location.href = base_path + "?key=" + keyword + "&page=1"
      }else{
        window.location.href = base_path + "?page=1"
      }
   })
   $("#datatable_previous a").click(function(){
      if(!!keyword){
        window.location.href = base_path + "?key=" + keyword + "&page=" + (current_page - 1)
      }else{
        window.location.href = base_path + "?page="  + (current_page - 1)
      }
   })
 }

 if(current_page == total_page){
   $("#datatable_next").hide()
   $("datatable_last").hide()
 }else{
    $("#datatable_last a").click(function(){
      if(!!keyword){
        window.location.href = base_path + "?key=" + keyword + "&page=" + total_page
      }else{
        window.location.href = base_path + "?page=" + total_page
      }
    })
    $("#datatable_next a").click(function(){
      if(!!keyword){
        window.location.href = base_path + "?key=" + keyword + "&page=" + (current_page + 1)
      }else{
        window.location.href = base_path + "?page=" + (current_page  + 1)
      }
    })
 }

 $("#datatable_filter .search-btn").click(function(){
    var key = $("#datatable_filter input").val()
    window.location.href = base_path + "?key=" + key
 })
</script>